{"title":"Windows搭建RabbitMq集群","uid":"2dc49ca3755c310977384158e8e18daf","slug":"Windows搭建RabbitMq集群","date":"2023-12-07T16:34:56.000Z","updated":"2023-12-08T01:32:55.616Z","comments":true,"path":"api/articles/Windows搭建RabbitMq集群.json","keywords":null,"cover":[],"content":"<h1 id=\"一、简述\"><a href=\"#一、简述\" class=\"headerlink\" title=\"一、简述\"></a>一、简述</h1><p>&ensp;&ensp;RabbitMQ 在 Linux 端的集群搭建可参考的教程很多，但 windows 端的相对较少，虽然生产环境肯定还是要在 Linux 上整的，但是本着不整好不痛快的精神，参考了好几篇博客，踩了一些坑，终于搭好了。😆😆😆</p>\n<h1 id=\"二、步骤\"><a href=\"#二、步骤\" class=\"headerlink\" title=\"二、步骤\"></a>二、步骤</h1><p>集群包括一个主节点，两个从节点，以下是操作步骤</p>\n<ol>\n<li><p>打开 windows 命令提示符，注意不是 powershell(后续需要在这个终端设置变量)<br><img src=\"/image/Windows%E6%90%AD%E5%BB%BARabbitMq%E9%9B%86%E7%BE%A4/1687607312573.png\" alt=\"1687607312573\"></p>\n</li>\n<li><p>新建三个命令提示符，每个终端负责每个节点的环境配置和启动，在每个命令提示符中依次执行设置环境变量，启动节点的命令。<br><code>第一、三行命令中的值是端口号，第二行的值是节点名称，可以根据需求更改</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置主节点</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_NODE_PORT=5673</span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_NODENAME=master</span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_SERVER_START_ARGS=-rabbitmq_management listener [&#123;port,15673&#125;]</span><br><span class=\"line\">rabbitmq-server.bat</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置从1节点</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_NODE_PORT=5674</span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_NODENAME=slave1</span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_SERVER_START_ARGS=-rabbitmq_management listener [&#123;port,15674&#125;]</span><br><span class=\"line\">rabbitmq-server.bat</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置从2节点</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_NODE_PORT=5675</span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_NODENAME=slave2</span><br><span class=\"line\"><span class=\"built_in\">set</span> RABBITMQ_SERVER_START_ARGS=-rabbitmq_management listener [&#123;port,15675&#125;]</span><br><span class=\"line\">rabbitmq-server.bat</span><br></pre></td></tr></table></figure></li>\n<li><p>新建一个终端，在终端内停止每个节点的运行并重置每个节点(防止创建集群时出现不同步等问题)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rabbitmqctl.bat -n master stop_app</span><br><span class=\"line\">rabbitmqctl.bat -n master reset</span><br><span class=\"line\"></span><br><span class=\"line\">rabbitmqctl.bat -n slave1 stop_app</span><br><span class=\"line\">rabbitmqctl.bat -n slave1 reset</span><br><span class=\"line\"></span><br><span class=\"line\">rabbitmqctl.bat -n slave2 stop_app</span><br><span class=\"line\">rabbitmqctl.bat -n slave2 reset</span><br></pre></td></tr></table></figure></li>\n<li><p>启动主节点</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rabbitmqctl.bat -n master start_app</span><br></pre></td></tr></table></figure></li>\n<li><p>从节点挂载到主节点下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rabbitmqctl.bat -n slave1 join_cluster master@workMachine</span><br><span class=\"line\">rabbitmqctl.bat -n slave2 join_cluster master@workMachine</span><br></pre></td></tr></table></figure></li>\n<li><p>启动从节点</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rabbitmqctl.bat -n slave1 start_app</span><br><span class=\"line\">rabbitmqctl.bat -n slave2 start_app</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h1 id=\"完成\"><a href=\"#完成\" class=\"headerlink\" title=\"完成\"></a>完成</h1><p>这时再进入主节点的控制界面就可以看到三个节点都在线了<br><img src=\"/image/Windows%E6%90%AD%E5%BB%BARabbitMq%E9%9B%86%E7%BE%A4/1687607211343.png\" alt=\"1687607211343\"><br>通过命令 <code>rabbitmqctl.bat cluster_status -n master</code>也可以看到三个节点的运行状况</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\hahaha&gt; rabbitmqctl.bat cluster_status -n master</span><br><span class=\"line\">Cluster status of node master@workMachine ...</span><br><span class=\"line\">Basics</span><br><span class=\"line\"></span><br><span class=\"line\">Cluster name: master@workMachine</span><br><span class=\"line\">Total CPU cores available cluster-wide: 48</span><br><span class=\"line\"></span><br><span class=\"line\">Disk Nodes</span><br><span class=\"line\"></span><br><span class=\"line\">master@workMachine</span><br><span class=\"line\">slave1@workMachine</span><br><span class=\"line\">slave2@workMachine</span><br><span class=\"line\"></span><br><span class=\"line\">Running Nodes</span><br><span class=\"line\"></span><br><span class=\"line\">master@workMachine</span><br><span class=\"line\">slave1@workMachine</span><br><span class=\"line\">slave2@workMachine</span><br><span class=\"line\"></span><br><span class=\"line\">Versions</span><br><span class=\"line\"></span><br><span class=\"line\">master@workMachine: RabbitMQ 3.12.0 on Erlang 26.0.1</span><br><span class=\"line\">slave1@workMachine: RabbitMQ 3.12.0 on Erlang 26.0.1</span><br><span class=\"line\">slave2@workMachine: RabbitMQ 3.12.0 on Erlang 26.0.1</span><br><span class=\"line\"></span><br><span class=\"line\">CPU Cores</span><br><span class=\"line\"></span><br><span class=\"line\">Node: master@workMachine, available CPU cores: 16</span><br><span class=\"line\">Node: slave1@workMachine, available CPU cores: 16</span><br><span class=\"line\">Node: slave2@workMachine, available CPU cores: 16</span><br></pre></td></tr></table></figure>\n","text":"一、简述&ensp;&ensp;RabbitMQ 在 Linux 端的集群搭建可参考的教程很多，但 windows 端的相对较少，虽然生产环境肯定还是要在 Li...","permalink":"/post/Windows搭建RabbitMq集群","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81%E7%AE%80%E8%BF%B0\"><span class=\"toc-text\">一、简述</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E6%AD%A5%E9%AA%A4\"><span class=\"toc-text\">二、步骤</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%AE%8C%E6%88%90\"><span class=\"toc-text\">完成</span></a></li></ol>","author":{"name":"孙冬冬","slug":"blog-author","avatar":"/image/avatar.jpg","link":"/","description":"哈哈哈","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"SpringSecurity6.0.1中角色继承无效的问题","uid":"412b935590a2bd04a88ed613c59b5969","slug":"SpringSecurity6.0.1中角色继承无效的问题","date":"2023-12-07T16:34:56.000Z","updated":"2023-12-08T01:33:01.692Z","comments":true,"path":"api/articles/SpringSecurity6.0.1中角色继承无效的问题.json","keywords":null,"cover":[],"text":"一、简述&ensp;&ensp;我在 SpringSecurity 中做了不少的实验，但总感觉对这个框架还是有点模糊，最近在复习 SpringSecurity，...","permalink":"/post/SpringSecurity6.0.1中角色继承无效的问题","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[],"tags":[],"author":{"name":"孙冬冬","slug":"blog-author","avatar":"/image/avatar.jpg","link":"/","description":"哈哈哈","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"集合类","uid":"3d7e70cb4fa6869d52e41f2f04e3c805","slug":"collection","date":"2023-12-07T16:34:56.000Z","updated":"2023-12-08T01:33:08.237Z","comments":true,"path":"api/articles/collection.json","keywords":null,"cover":null,"text":"一、内容整理ArrayList底层原理及构造函数相关ArrayList 底层维护一个数组 elementData，共有三个构造函数 无参构造：将一个空数组赋值给...","permalink":"/post/collection","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"孙冬冬","slug":"blog-author","avatar":"/image/avatar.jpg","link":"/","description":"哈哈哈","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}